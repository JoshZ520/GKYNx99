<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Talk - Offline Setup</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css">
    <link rel="stylesheet" href="../stylesheets/shared.css">
    <link rel="stylesheet" href="../stylesheets/index.css">
    <link rel="stylesheet" href="stylesheets/player-setup.css">
    <link rel="stylesheet" href="stylesheets/front-pg-custom.css">
    <script src="../scripts/session-utilities.js" defer></script>
    <script src="../scripts/theme-utilities.js" defer></script>
    <script src="scripts/front-offline.js" defer></script>
    <script src="scripts/player-setup.js" defer></script>
</head>
<body class="front-page" id="root">
    <div class="card">
        <header>
            <h1>Table Talk</h1>
            <p class="tagline">Offline Mode - Single Device Game</p>
            <p class="lead" id="front-instruction">Everyone takes turns on this device - pass it around after each turn!</p>
        </header>

        <main>
            <!-- Offline Game Setup Section -->
            <div class="new-game-section" id="offlineGameSection">
                <!-- Step 1: Player Count -->
                <div class="step-section" id="playerCountStep">
                    <h3>Step 1: Choose Players</h3>
                    <p class="step-instruction">Select how many players will be taking turns:</p>
                    <div class="create-room-container">
                        <div class="player-count-selector">
                            <label for="player_count">Number of Players:</label>
                            <select id="player_count" required onchange="generatePlayerInputs(this.value)">
                                <option value="" disabled selected>Select number</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>
                        </div>
                    </div>

                </div>

                <!-- Step 2: Player Names -->
                <div class="step-section hidden" id="playerNamesStep">
                    <h3>Step 2: Enter Player Names</h3>
                    <p class="step-instruction">Add names for each player who will be participating:</p>
                    
                    <div class="players-joining">
                        <h4>Player Names:</h4>
                        <div id="playerNamesContainer" class="players-list">
                            <!-- Player name inputs will be generated here -->
                        </div>
                    </div>

                    <!-- Start Game Button -->
                    <div class="start-game-container">
                        <button class="start-btn disabled" id="startGame" type="button" disabled>
                            <span id="startGameText">Fill all player names to start</span>
                        </button>
                        <p class="min-players-note">All players need names to begin</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="step-section">
                <div class="offline-container">
                    <a href="../index.html" class="secondary-btn" style="text-decoration: none; display: inline-block;">‚Üê Back to Multiplayer</a>
                </div>
            </div>
        </main>
    </div>

<script>
function generatePlayerInputs(selectedValue) {
    console.log('generatePlayerInputs called with:', selectedValue);
    
    const count = parseInt(selectedValue, 10);
    const playerNamesStep = document.getElementById('playerNamesStep');
    const playerNamesContainer = document.getElementById('playerNamesContainer');
    
    if (isNaN(count) || count < 2 || count > 10) {
        if (playerNamesStep) playerNamesStep.classList.add('hidden');
        return;
    }
    
    // Show step 2
    if (playerNamesStep) {
        playerNamesStep.classList.remove('hidden');
    }
    
    // Generate player inputs
    if (playerNamesContainer) {
        playerNamesContainer.innerHTML = '';
        
        for (let i = 1; i <= count; i++) {
            const playerDiv = document.createElement('div');
            playerDiv.className = 'player-name-input';
            
            const label = document.createElement('label');
            label.textContent = `Player ${i}:`;
            label.htmlFor = `player_${i}`;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.id = `player_${i}`;
            input.name = `player_${i}`;
            input.placeholder = `Enter name for Player ${i}`;
            input.required = true;
            
            playerDiv.appendChild(label);
            playerDiv.appendChild(input);
            playerNamesContainer.appendChild(playerDiv);
        }
        
        // Update start button
        updateStartButton();
    }
}

function updateStartButton() {
    const startBtn = document.getElementById('startGame');
    const inputs = document.querySelectorAll('#playerNamesContainer input');
    const allFilled = Array.from(inputs).every(input => input.value.trim().length > 0);
    
    if (startBtn) {
        if (allFilled && inputs.length > 0) {
            startBtn.disabled = false;
            startBtn.classList.remove('disabled');
            startBtn.querySelector('span').textContent = 'Start Offline Game';
        } else {
            startBtn.disabled = true;
            startBtn.classList.add('disabled');
            startBtn.querySelector('span').textContent = 'Fill all player names to start';
        }
    }
}

// Add input event listeners when inputs are created
document.addEventListener('input', function(e) {
    if (e.target.matches('#playerNamesContainer input')) {
        updateStartButton();
    }
});
</script>
</body>
</html>